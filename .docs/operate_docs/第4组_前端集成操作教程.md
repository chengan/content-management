# 第4组：前端集成操作教程

## 📋 教程概述

这个教程将指导你完成前端与真实API的集成，让网站从使用模拟数据切换到真实的Supabase数据库。

## 🎯 学习目标

完成后你将学会：
- 创建API客户端来与后端通信
- 修改前端状态管理使用真实数据
- 更新页面组件连接真实API
- 添加用户体验优化功能

## 📝 任务清单

### Task 4.1: API客户端封装
**目标：** 创建一个统一的API客户端，管理所有与后端的通信

**步骤说明：**
1. 创建 `lib/api.ts` 文件
2. 封装所有API请求方法（获取、创建、更新、删除素材）
3. 实现统一错误处理
4. 添加TypeScript类型安全

**文件位置：** `lib/api.ts`

### Task 4.2: Context状态管理更新
**目标：** 修改全局状态管理，从使用模拟数据改为使用真实API

**步骤说明：**
1. 修改 `src/contexts/AppContext.tsx` 文件
2. 移除对mock-data的依赖
3. 实现loading状态管理
4. 添加错误状态处理

**文件位置：** `src/contexts/AppContext.tsx`

### Task 4.3: 页面组件修改
**目标：** 更新所有页面组件使用真实API而不是模拟数据

**步骤说明：**
1. 更新素材列表页面 (`app/materials/page.tsx`)
2. 修改素材详情页面
3. 调整编辑功能集成API
4. 更新删除功能使用真实API

### Task 4.4: 用户体验优化
**目标：** 添加各种用户体验改进功能

**步骤说明：**
1. 添加全局loading指示器
2. 实现乐观更新提升体验
3. 完善错误信息展示
4. 添加成功操作提示反馈

## 🔧 技术要点

### API客户端设计模式
```typescript
// 标准API响应格式
interface ApiResponse<T> {
  success: boolean;
  data?: T;
  error?: string;
  pagination?: {
    page: number;
    limit: number;
    total: number;
  };
}

// API方法示例
async function getMaterials(params: GetMaterialsParams): Promise<ApiResponse<Article[]>>
```

### 状态管理模式
```typescript
// Context状态结构
interface AppState {
  materials: Article[];
  loading: boolean;
  error: string | null;
  // ... 其他状态
}

// 操作方法
interface AppActions {
  fetchMaterials: () => Promise<void>;
  updateMaterial: (id: string, data: Partial<Article>) => Promise<void>;
  deleteMaterial: (id: string) => Promise<void>;
  // ... 其他操作
}
```

## ⚠️ 注意事项

1. **不要修改页面样式**：只做数据对接，保持原有UI设计
2. **类型安全**：确保所有API调用都有正确的TypeScript类型
3. **错误处理**：为每个API调用添加适当的错误处理
4. **loading状态**：在数据加载时显示loading指示器
5. **用户反馈**：操作成功或失败时给用户明确的反馈

## 📁 文件结构

完成后的文件结构：
```
project/
├── lib/
│   └── api.ts                    # 新增：API客户端
├── src/
│   ├── contexts/
│   │   └── AppContext.tsx        # 修改：使用真实API
│   └── components/
│       └── ...                   # 修改：相关组件
└── app/
    └── materials/
        └── page.tsx              # 修改：素材列表页面
```

## 🎉 完成标志

当以下条件都满足时，表示第4组任务完成：
- [ ] API客户端创建完成，所有方法都有类型定义
- [ ] AppContext不再使用mock数据，改用真实API
- [ ] 素材列表页面能正常显示真实数据
- [ ] 添加、编辑、删除功能都使用真实API
- [ ] 有loading状态和错误处理
- [ ] 用户操作有成功/失败反馈

完成后网站将完全使用真实数据库，不再依赖模拟数据！

---

**创建时间：** 2025-08-22  
**预计完成时间：** 6小时  
**难度等级：** ⭐⭐⭐（中等）